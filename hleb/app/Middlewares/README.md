# Директория `app/Middlewares`

Директория `app/Middlewares/` в Hleb-приложении предназначена для размещения классов промежуточного программного обеспечения (middleware). Middleware — это код, который выполняется *до* или *после* того, как основной обработчик маршрута (обычно метод контроллера) выполнит свою работу. Они представляют собой слои, через которые проходит запрос (и ответ).

## Основное назначение

Middleware используются для выполнения сквозных задач (cross-cutting concerns), таких как:
*   Аутентификация и авторизация пользователей.
*   Проверка CSRF-токенов.
*   Логирование запросов.
*   Модификация входящих запросов или исходящих ответов (например, добавление HTTP-заголовков).
*   Управление сессиями.
*   Обработка CORS-запросов.

## Содержимое и его роль

Каждый `.php` файл в этой директории обычно представляет собой класс middleware, реализующий определенный интерфейс или наследуемый от базового класса middleware фреймворка Hleb.

*   **`DefaultMiddleware.php`**:
    *   **Назначение:** Вероятно, это пример или стандартный middleware, поставляемый с Hleb. Он может выполнять какие-то общие для всех запросов действия или служить шаблоном для создания пользовательских middleware.
    *   **Для бота:** Его можно изучить для понимания того, как создавать и регистрировать свои middleware.

## Влияние на разработку Telegram-бота и интернет-магазина

Middleware могут быть очень полезны при разработке вашего Telegram-бота и интернет-магазина:

*   **Аутентификация администратора:** Создание middleware для защиты маршрутов админ-панели магазина, проверяющего, является ли пользователь администратором. (Планируется как `AdminAuthMiddleware` в `hleb/app/Shop/Common/Middlewares/` или аналогичном месте).
*   **Аутентификация пользователя:** Для API-эндпоинтов Mini App или для команд бота, требующих идентификации пользователя (например, просмотр истории заказов), можно создать middleware, проверяющий сессию или токен пользователя. (Планируется как `UserAuthMiddleware`).
*   **Проверка подписи запроса от Telegram:** Для дополнительной безопасности вебхука можно создать middleware, которое проверяет хеш-сумму или другие параметры запроса от Telegram.
*   **API Rate Limiting:** Ограничение количества запросов к API вашего Mini App для предотвращения злоупотреблений.
*   **Подготовка данных для Mini App:** Middleware может подготавливать общие данные, необходимые для всех ответов API Mini App.

Хотя стандартная директория `app/Middlewares/` может содержать только `DefaultMiddleware.php`, для вашего интернет-магазина вы, скорее всего, создадите несколько специализированных middleware в соответствующей поддиректории вашего модуля `app/Shop/` (например, `app/Shop/Common/Middlewares/`).
